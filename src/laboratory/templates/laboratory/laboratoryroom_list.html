{% extends 'base.html' %}
{% load gtsettings i18n shelf_position static laboratory %}
{% load urlname_tags %}
{% load organilab_tags %}
{% load furniture_tags %}

{% block pre_head %}

    {% define_true  "use_datatables" %}
	{% define_urlname_action 'rooms_list' %}
	{% define_urlname_action 'furniture_list' %}
	{% define_urlname_action 'list_shelf' %}
	{% define_urlname_action 'list_shelfobject' %}
	{% define_urlname_action 'edit_object' %}
	{% define_urlname_action 'get_object_detail' %}
	{% define_urlname_action 'reports_shelf_objects' %}
	{% define_urlname_action 'shelfobject_create' %}
	{% define_urlname_action 'shelfobject_delete' %}
	{% define_urlname_action 'shelfobject_edit' %}
	{% define_urlname_action 'shelf_create' %}
	{% define_urlname_action 'shelf_delete' %}
	{% define_urlname_action 'shelf_edit' %}
	{% define_urlname_action 'transfers' %}
	{% define_urlname_action 'manage_disposal' %}

{% endblock %}
{% block title %}{% trans 'Laboratory rooms' %}{% endblock %}
{# Container #}
{% block container %}container-fluid{% endblock %}

{% block content %}
<input type="hidden" name="organization" id="id_organization" value="{{org_pk}}">
<input type="hidden" name="laboratory" id="id_laboratory" value="{{laboratory}}">

    {% include 'laboratory/search_widget.html' %}
{#   {% include 'laboratory/reservation_modal.html' %} #}
    {% include 'laboratory/shelfobject/action_modal.html' %}

    <h1 class="text-center">{% get_laboratory_name %}</h1>
<div class="input-group nomargin">
    <div class="input-group-text">
    <a class="h-100" data-bs-toggle="collapse" href="#collapselabroom" role="button" aria-expanded="false" aria-controls="collapselabroom">
        <i class="fa fa-bars"></i>
    </a>
    </div>

    <input name="tags-search" type="text" class="form-control" >
</div>
<div class="container laboratoryfilter" >

<div id="collapselabroom" class="collapse show" >
        <ul class="ullabroom">

    {% for LaboratoryRoom in object_list %}
            <li> <a href="#bingi" target="_blank"> <i class="fa fa-qrcode" aria-hidden="true"></i></a> <span class="box">{{LaboratoryRoom}} </span>
            <ul class="nested ulfurnuture">

                {% for furniture in LaboratoryRoom.furniture_set.all %}
                <li>

                    <a href="#m{{furniture.pk}}" data-bs-toggle="modal" data-bs-target="#m{{furniture.pk}}" style="color: {{furniture.color}}"> <i class="fa fa-qrcode" aria-hidden="true"></i> </a>
<div class="modal fade" id="m{{furniture.pk}}" tabindex="-1" aria-labelledby="m{{furniture.pk}}Label" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="m{{furniture.pk}}Label">{% trans "Use this QR to fast access to" %}
         <span  style="color: {{furniture.color}}" >{{furniture}}</span>
        </h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
       {% get_qr_svg_img furniture organization=org_pk %}
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">{% trans 'Close' %}</button>
      </div>
    </div>
  </div>
</div>


                       <a href="{% url 'laboratory:reports_furniture_detail' org_pk=org_pk lab_pk=laboratory %}?laboratory={{laboratory}}&furniture={{furniture.pk}}" target="_blank" style="color: {{furniture.color}}">  <i class="fa fa-file-pdf-o" aria-hidden="true"></i> </a>
                    <span class="box" style="color: {{furniture.color}}" >{{furniture}}</span>
                    <ul class="nested">
                        <li>{{ furniture|display_furniture }}</li>
                    </ul>
                </li>
                {% endfor %}

            </ul>
        </li>
    {% endfor %}
      </ul>
</div>

</div>
<div class="row">
<table class="table table-striped" id="shelfobjecttable"></table>
</div>



{% include 'laboratory/shelfobjectUpdate_modal.html' %}

<div id="shelfdetailmodal" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div id="shelfdetailmodalbody" class="modal-content">

        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<div id="closemodal"></div>
{% endblock %}

{% block css %}
<link href="{% static 'laboratory/css/laboratory.css' %}?v={% get_organilab_version %}" rel="stylesheet" >
{% endblock %}

{% block js %}
{{block.super}}
<script>
document.urls = {
    shelfobject_create: "{% url 'laboratory:shelfobject_create' lab_pk=laboratory org_pk=org_pk  %}",
    transfer_list: '{% url "laboratory:api-shelfobject-transfer-available-list" org_pk laboratory %}',
    shelf_availability_information: '{% url "laboratory:api-shelfobject-shelf-availability-information" lab_pk=laboratory org_pk=org_pk %}'
}
document.furniture_list = '{% url "laboratory:furniture_list" lab_pk=laboratory org_pk=org_pk %}';
document.shelfobject_list = '{% url "laboratory:list_shelfobject" lab_pk=laboratory org_pk=org_pk %}';
document.api_modal = '{% url "laboratory:api_reservation_create"%}';
document.date_validation_script_url = '{% url "laboratory:date_validator"%}';
document.url_shelfobject = '{% url "laboratory:api-shelfobjecttable-list" org_pk laboratory %}';
const view_search = false;

</script>

<script src="{% static 'js/shelfobjectedit.js' %}?v={% get_organilab_version %}"></script>
<script src="{% static 'js/reservationmodal.js' %}?v={% get_organilab_version %}"></script>

<script type="text/javascript" src="{% static 'laboratory/js/laboratory.js'%}?v={% get_organilab_version %}"></script>


<script>
    window.onload = load_self_from_uls();
</script>

{% endblock %}