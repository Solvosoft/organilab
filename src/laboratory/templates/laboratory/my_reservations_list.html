{% extends 'base.html' %}
{% load static i18n gtsettings %}
{% load timejs %}
{% block title %}{% trans 'My reservations' %}{% endblock %}
{% block extra_css %}
  <link href="{% static 'css/custom.css' %}" rel="stylesheet">
{% endblock %}
{% block pre_head %}
   {% define_true "use_datatables" as use_datatables %}
{% endblock %}

{% block content %}
    {% include 'laboratory/my_reservation_delete.html' %}
    {% include 'laboratory/my_reservation_delete_all.html' %}
    <div id="management_buttons">


            <label> show all product reservations: </label>
            <label class="switch">
                <input id="showAllProducts" type="checkbox">
                <span class="slider round"></span>
            </label>

        <input data-toggle="modal"
            data-target="#delete_all_obj_reservation_modal" type="button"
            disabled="disabled" value="{% trans 'Cancel all selected products' %}" class="pull-right btn btn-danger"
            id="cancel_all_products_btn">
        <input id="reserve_btn" class="pull-right btn btn-success" type="button" onclick="make_reservation()" disabled="disabled" value='{% trans "Reserve" %}'>

    </div>
    <table id="table_id" class="display table table-striped table-bordered" style="width:100%">

    </table>
{% endblock %}
{% block js %}
    <script>
        document.get_lab_id_script_url = '{% url "laboratory:get_lab_id"%}';
        document.api_modal_delete = '{% url "laboratory:api_reservation_delete" 0%}';
        document.api_create_reservation = '{% url "laboratory:api_individual_reservation_create"%}';
        document.api_update_product = '{% url "laboratory:api_reservation_update" 0%}';
        document.api_get_product = '{% url "laboratory:api_reservation_detail" 0%}';
    </script>
    <!--<script type="text/javascript" src="{% static 'js/my_reservations.js' %}"></script>-->

<script>
function filterFunction(dataTableParams,settings){
  var data = formatDataTableParams(dataTableParams, settings);

  data['subfiltrar']=1;
  return data;
}

  datatableelement=createDataTable('#table_id', '{% url "api-reservedproduct-list" %}', {

     columns: [
            {data: "shelf_object", name: "shelf_object__object__name", title: "shelf object", type: "string", visible: true},
            {data: "amount_required", name: "amount_required", title: "amount required", type: "string", visible: true},
            {data: "initial_date", name: "initial_date", title: "initial date", type: "date", visible: true, "dateformat": "{% get_date_format %}"},
            {data: "final_date", name: "final_date", title: "final date", type: "date", visible: true, "dateformat":  "{% get_date_format %}"},
            {data: "status", name: "status", title: "status", type: "number", visible: true},
            {data: "action", name: "action", title: "action", type: "readonly", visible: true},
        ]
    }, addfilter=true, formatDataTableParamsfnc=filterFunction);

</script>
{% endblock %}