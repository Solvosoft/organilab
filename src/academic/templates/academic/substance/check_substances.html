{% extends 'base.html' %}
{% load static i18n gtsettings label_tags %}

{% load urlname_tags %}
{% block pre_head %}
    {% define_true  "use_datatables" %}
    {% define_urlname_action 'detail_substance' %}
    {% define_urlname_action 'security_leaf_pdf' %}
    {% define_urlname_action 'get_preview' %}
{% endblock %}

{% block content %}
<div class="row justify-content-center">
<div class="col-md-8">
        <div class="page-header col-sm-13" align="center">
          <h3>{% trans 'List of Substances' %}</h3>
        </div>
</div>
</div>

<div class="row">
<div class="col-md-12">
  <table id="sustancetable" class="table table-sm table-striped table-bordered" style="width:100%">
        <thead>
            <tr>
                <th class="text-center">{% trans 'Creator' %}</th>
                <th class="text-center">{% trans 'Substances' %}</th>
                <th class="text-center">{% trans 'Actions' %}</th>
            </tr>
        </thead>
        <tbody>
            {% for substance in substances %}
                           {% get_personal_template substance.pk as template %}

                <tr class="text-center">
                    <td>{{substance.creator}}</td>
                    <td>{{substance.comercial_name}}</td>
                    <td><button title="{% trans 'Approve' %}" type="button" data-bs-toggle="modal" data-bs-target="#svgtemplate" data-substance="{{substance.pk}}" class="btn btn-info text-white btn_review"><i class="icons fa fa-check"></i></button>
                        <a class="btn btn-warning" title="{% trans 'Detail' %}" href="{% url 'detail_substance' organilabcontext substance.pk %}"><i class="icons fa fa-eye"></i></a>
                        {% if template %}
                        <!--<a class="btn  btn-md  btn-info btnpreview" title="{% trans 'Preview' %}" data-id="{{template}}"><i class="icons fa fa-eye"></i></a>
                        <a class="btn  btn-md  btn-primary" title="{% trans 'Generate PNG' %}" href="{% url 'sga:get_svgexport' 0 template %}"><i class="icons fa fa-file-image-o" aria-hidden="true"></i></a>
                        <a class="btn  btn-md  btn-danger" title="{% trans 'Generate PDF' %}" href="{% url 'sga:get_svgexport' 1 template %}"><i class="icons fa fa-file-pdf-o" aria-hidden="true"></i></a>
                        -->
                        <a class="btn  btn-md  btn-danger" title="{% trans 'Generate PDF' %}" href="{% url 'security_leaf_pdf' substance.pk %}"><i class="icons fa fa-file-pdf-o" aria-hidden="true"></i></a>
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
        </tbody>
  </table>
</div>
</div>
<div class="modal fade bs-example-modal-lg" id="svgtemplate" tabindex="-1"
        role="dialog" aria-hidden="true" data-backdrop="static">
        <div class="stylo modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">{% trans 'Preview' %}</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center">
                    <img>
                </div>
            </div>
        </div>
    </div>

<div class="modal fade bs-example-modal-sm" id="review_substance" tabindex="-1"
        role="dialog" aria-hidden="true" data-backdrop="static">
        <div class="stylo modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">{% trans 'Substance' %}</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form action="" method="post">
                        {{form.as_inline}}
                        <button class="btn btn-success">{% trans 'Approve'%}</button>
                    </form>

                </div>
            </div>
        </div>
    </div>

{% endblock %}

{% block js %}
{{block.super}}

<script>

(function(){
    $("#sustancetable").DataTable();
})(jQuery);

$(".btn_review").on('click', function(){
    var id = $(this).data('substance');
    //$("#review_substance").modal();

});
</script>
<script>
    document.url_get_preview = "{% url 'sga:get_preview' organilabcontext 0 %}";
</script>
<script type="text/javascript" src="{% static 'sga/js/personal_template.js' %}"></script>


{% endblock %}