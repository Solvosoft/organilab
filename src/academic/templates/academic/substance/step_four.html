{% extends 'base.html' %}
{% load static i18n %}

{% block content %}
<div class="container">
    <div class="row">
        <div class="col-md-12">
                {% include 'academic/substance/steps.html' %}
            <br>
        </div>
    </div>
    <form action="{% url 'step_four' organilabcontext substance %}" method="POST">
    {% csrf_token %}

    <div class="row">
        <div class="col-sm-offset-2 col-md-8" >
           <!--{{ form.as_inline }} -->
            <div class = "container">
                <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                    <div class="panel panel-default">
                        <div class="panel-heading" role="tab" id="heading">
                            <h4 class="panel-title">
                                <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseZero" aria-expanded="false" aria-controls="collapseZero">
                                    Proveedores
                                </a>
                            </h4>
                        </div>
                        <div id="collapseZero" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingZero">
                            <div class="panel-body">
                               <div class="row">
                                    <div class="col-sm-12">
                                        <div class="form-group">
                                            {{ form.provider.label_tag }}
                                            <br>
                                            <div class="input-group">
                                                <span class="input-group-addon btn btn-success text-white" title="{% trans 'Add' %}" data-toggle="modal" data-target="#provider_modal" style="color: white !important;">+</span>
                                                {{ form.provider }}
                                            </div>
                                        </div>
                                    </div>
                               </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel panel-default">
                        <div class="panel-heading" role="tab" id="headingOne">
                            <h4 class="panel-title">
                                <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                    Primeros Auxilios
                                </a>
                            </h4>
                        </div>
                        <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
                            <div class="panel-body">
                                <div class="row">
                                    <div class="col-sm-6">
                                         <div class="form-group">
                                            {{ form.general.label_tag }} {{ form.general }}
                                         </div>
                                         <div class="form-group">
                                            {{ form.inhalation.label_tag }} {{ form.inhalation }}
                                         </div>
                                         <div class="form-group">
                                            {{ form.skin_contact.label_tag }} {{ form.skin_contact }}
                                         </div>
                                         <div class="form-group">
                                            {{ form.eye_contact.label_tag }} {{ form.eye_contact }}
                                         </div>
                                    </div>
                                    <div class="col-sm-6">
                                         <div class="form-group">
                                            {{ form.ingestion.label_tag }} {{ form.ingestion }}
                                         </div>
                                         <div class="form-group">
                                            {{ form.symptoms.label_tag }} {{ form.symptoms }}
                                         </div>
                                         <div class="form-group">
                                            {{ form.other_causes.label_tag }} {{ form.other_causes }}
                                         </div>
                                         <div class="form-group">
                                            {{ form.medical_indication.label_tag }} {{ form.medical_indication }}
                                         </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel panel-default">
                        <div class="panel-heading" role="tab" id="headingTwo">
                            <h4 class="panel-title">
                                <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                    Medidas de lucha contra incendios
                                </a>
                            </h4>
                        </div>
                        <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
                            <div class="panel-body">
                               <div class="row">
                                    <div class="col-sm-6">
                                         <div class="form-group">{{ form.appropriate.label_tag }} {{ form.appropriate }}</div>
                                         <div class="form-group">{{ form.no_appropriate.label_tag }} {{ form.no_appropriate }}</div>
                                         <div class="form-group">{{ form.specific_dangers.label_tag }} {{ form.specific_dangers }}</div>
                                    </div>
                                    <div class="col-sm-6">
                                         <div class="form-group">{{ form.combustion_products.label_tag }} {{ form.combustion_products }}</div>
                                         <div class="form-group">{{ form.recomendations.label_tag }} {{ form.recomendations }}</div>
                                         <div class="form-group">{{ form.other_info.label_tag }} {{ form.other_info }}</div>
                                    </div>

                               </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel panel-default">
                        <div class="panel-heading" role="tab" id="headingThree">
                            <h4 class="panel-title">
                                <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="false" aria-controls="collapseTwo">
                                    Medidas en caso de vertido accidental
                                </a>
                            </h4>
                        </div>
                        <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
                            <div class="panel-body">
                               <div class="row">
                                    <div class="col-sm-6">
                                         <div class="form-group">{{ form.personal_caution.label_tag }} {{ form.personal_caution }}</div>
                                         <div class="form-group">{{ form.environmental_caution.label_tag }} {{ form.environmental_caution }}</div>
                                    </div>
                                    <div class="col-sm-6">
                                         <div class="form-group">{{ form.methods_material_contention.label_tag }} {{ form.methods_material_contention }}</div>
                                         <div class="form-group">{{ form.references_sections.label_tag }} {{ form.references_sections }}</div>
                                    </div>
                               </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel panel-default">
                        <div class="panel-heading" role="tab" id="headingFour">
                            <h4 class="panel-title">
                                <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                                    Manipulaci√≥n Almacenamiento
                                </a>
                            </h4>
                        </div>
                        <div id="collapseFour" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingFour">
                            <div class="panel-body">
                               <div class="row">
                                    <div class="col-sm-12">
                                         <div class="form-group">{{ form.safe_handling.label_tag }} {{ form.safe_handling }}</div>
                                         <div class="form-group">{{ form.storage_conditions.label_tag }} {{ form.storage_conditions }}</div>
                                         <div class="form-group">{{ form.specific_end_uses.label_tag }} {{ form.specific_end_uses }}</div>
                                    </div>
                               </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel panel-default">
                        <div class="panel-heading" role="tab" id="headingFive">
                            <h4 class="panel-title">
                                <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
                                    Controles de exposici√≥n/protecci√≥n individual
                                </a>
                            </h4>
                        </div>
                        <div id="collapseFive" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingFive">
                            <div class="panel-body">
                               <div class="row">
                                    <div class="col-sm-6">
                                         <div class="form-group">{{ form.vla_ed_pp.label_tag }} {{ form.vla_ed_pp }}</div>
                                         <div class="form-group">{{ form.vla_ed_mg.label_tag }} {{ form.vla_ed_mg }}</div>
                                         <div class="form-group">{{ form.vla_ec_pp.label_tag }} {{ form.vla_ec_pp }}</div>
                                         <div class="form-group">{{ form.vla_ec_mg.label_tag }} {{ form.vla_ec_mg }}</div>
                                         <div class="form-group">{{ form.vla_vm_mg.label_tag }} {{ form.vla_vm_mg }}</div>
                                         <div class="form-group">{{ form.vla_vm_mg.label_tag }} {{ form.vla_vm_mg }}</div>
                                    </div>
                                    <div class="col-sm-6">
                                         <div class="form-group">{{ form.approppiate_control.label_tag }} {{ form.approppiate_control }}</div>
                                         <div class="form-group">{{ form.eye_face_protection.label_tag }} {{ form.eye_face_protection }}</div>
                                         <div class="form-group">{{ form.skin_protection.label_tag }} {{ form.skin_protection }}</div>
                                         <div class="form-group">{{ form.corporal_protection.label_tag }} {{ form.corporal_protection }}</div>
                                         <div class="form-group">{{ form.breath_protection.label_tag }} {{ form.breath_protection }}</div>
                                         <div class="form-group">{{ form.environmental_exposition.label_tag }} {{ form.environmental_exposition }}</div>
                                    </div>

                               </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel panel-default">
                        <div class="panel-heading" role="tab" id="headingSix">
                            <h4 class="panel-title">
                                <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseSix" aria-expanded="false" aria-controls="collapseSix">
                                    Propiedades f√≠sicas y qu√≠mica
                                </a>
                            </h4>
                        </div>
                        <div id="collapseSix" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingSix">
                            <div class="panel-body">
                               <div class="row">
                                    <div class="col-sm-6">
                                         <div class="form-group">{{ form.aspect.label_tag }} {{ form.aspect }}</div>
                                         <div class="form-group">{{ form.smell.label_tag }} {{ form.smell }}</div>
                                         <div class="form-group">{{ form.olfactory_threshold.label_tag }} {{ form.olfactory_threshold }}</div>
                                         <div class="form-group">{{ form.pH.label_tag }} {{ form.pH }}</div>
                                         <div class="form-group">{{ form.melting_point.label_tag }} {{ form.melting_point }}</div>
                                         <div class="form-group">{{ form.starting_point_boiling.label_tag }} {{ form.starting_point_boiling }}</div>
                                         <div class="form-group">{{ form.flashpoint.label_tag }} {{ form.flashpoint }}</div>
                                         <div class="form-group">{{ form.evaporation_rate.label_tag }} {{ form.evaporation_rate }}</div>
                                         <div class="form-group">{{ form.inflammability_solid_gas.label_tag }} {{ form.inflammability_solid_gas }}</div>
                                         <div class="form-group">{{ form.Inflammability_top_bottom.label_tag }} {{ form.Inflammability_top_bottom }}</div>
                                    </div>
                                    <div class="col-sm-6">
                                         <div class="form-group">{{ form.vapor_density.label_tag }} {{ form.vapor_density }}</div>
                                         <div class="form-group">{{ form.vapor_density.label_tag }} {{ form.vapor_density }}</div>
                                         <div class="form-group">{{ form.relative_density.label_tag }} {{ form.relative_density }}</div>
                                         <div class="form-group">{{ form.water_solubility.label_tag }} {{ form.water_solubility }}</div>
                                         <div class="form-group">{{ form.partition_coefficient.label_tag }} {{ form.partition_coefficient }}</div>
                                         <div class="form-group">{{ form.auto_temperature_inflammation.label_tag }} {{ form.auto_temperature_inflammation }}</div>
                                         <div class="form-group">{{ form.temperature_decomposition.label_tag }} {{ form.temperature_decomposition }}</div>
                                         <div class="form-group">{{ form.viscosity.label_tag }} {{ form.viscosity }}</div>
                                         <div class="form-group">{{ form.explosive_properties.label_tag }} {{ form.explosive_properties }}</div>
                                         <div class="form-group">{{ form.properties_oxidising.label_tag }} {{ form.properties_oxidising }}</div>
                                    </div>

                               </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel panel-default">
                        <div class="panel-heading" role="tab" id="headingSeven">
                            <h4 class="panel-title">
                                <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseSeven" aria-expanded="false" aria-controls="collapseSeven">
                                    Estabilidad y Reactividad
                                </a>
                            </h4>
                        </div>
                        <div id="collapseSeven" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingSeven">
                            <div class="panel-body">
                               <div class="row">
                                    <div class="col-sm-6">
                                         <div class="form-group">{{ form.reactivity.label_tag }} {{ form.reactivity }}</div>
                                         <div class="form-group">{{ form.chemical_stability.label_tag }} {{ form.chemical_stability }}</div>
                                         <div class="form-group">{{ form.dangerous_reactions.label_tag }} {{ form.dangerous_reactions }}</div>
                                    </div>
                                    <div class="col-sm-6">
                                         <div class="form-group">{{ form.conditions_avoid.label_tag }} {{ form.conditions_avoid }}</div>
                                         <div class="form-group">{{ form.incompatible_materials.label_tag }} {{ form.incompatible_materials }}</div>
                                         <div class="form-group">{{ form.dangerous_decomposition_products.label_tag }} {{ form.dangerous_decomposition_products }}</div>
                                    </div>
                               </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel panel-default">
                        <div class="panel-heading" role="tab" id="headingEight">
                            <h4 class="panel-title">
                                <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseEight" aria-expanded="false" aria-controls="collapseEight">
                                    Informaci√≥n Toxicologica
                                </a>
                            </h4>
                        </div>
                        <div id="collapseEight" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingEight">
                            <div class="panel-body">
                               <div class="row">
                                    <div class="col-sm-6">
                                         <div class="form-group">{{ form.acute_toxicity.label_tag }} {{ form.acute_toxicity }}</div>
                                         <div class="form-group">{{ form.skin_irritation.label_tag }} {{ form.skin_irritation }}</div>
                                         <div class="form-group">{{ form.eye_irritation.label_tag }} {{ form.eye_irritation }}</div>
                                         <div class="form-group">{{ form.respiratory_sensitization.label_tag }} {{ form.respiratory_sensitization }}</div>
                                         <div class="form-group">{{ form.germ_mutagenicity.label_tag }} {{ form.germ_mutagenicity }}</div>
                                         <div class="form-group">{{ form.carcinogenicity.label_tag }} {{ form.carcinogenicity }}</div>
                                    </div>
                                    <div class="col-sm-6">
                                         <div class="form-group">{{ form.reproductive_toxicity.label_tag }} {{ form.reproductive_toxicity }}</div>
                                         <div class="form-group">{{ form.unique_exhibition.label_tag }} {{ form.unique_exhibition }}</div>
                                         <div class="form-group">{{ form.repeated_exposures.label_tag }} {{ form.repeated_exposures }}</div>
                                         <div class="form-group">{{ form.aspiration_hazard.label_tag }} {{ form.aspiration_hazard }}</div>
                                         <div class="form-group">{{ form.additional_information.label_tag }} {{ form.additional_information }}</div>
                                    </div>
                               </div>
                            </div>
                        </div>
                    </div>
                <div class="panel panel-default">
                    <div class="panel-heading" role="tab" id="headingNine">
                        <h4 class="panel-title">
                            <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseNine" aria-expanded="false" aria-controls="collapseNine">
                                Informaci√≥n Ecol√≥gica
                            </a>
                        </h4>
                    </div>
                    <div id="collapseNine" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingNine">
                        <div class="panel-body">
                            <div class="row">
                                <div class="col-sm-6">
                                    <div class="form-group">{{ form.toxicity.label_tag }} {{ form.toxicity }}</div>
                                    <div class="form-group">{{ form.Persistence_degradability.label_tag }} {{ form.Persistence_degradability }}</div>
                                    <div class="form-group">{{ form.bioaccumulative_potential.label_tag }} {{ form.bioaccumulative_potential }}</div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="form-group">{{ form.soil_mobility.label_tag }} {{ form.soil_mobility }}</div>
                                    <div class="form-group">{{ form.assessment_result.label_tag }} {{ form.assessment_result }}</div>
                                    <div class="form-group">{{ form.other_adverse_effects.label_tag }} {{ form.other_adverse_effects }}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="panel panel-default">
                    <div class="panel-heading" role="tab" id="headingTen">
                        <h4 class="panel-title">
                            <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseTen" aria-expanded="false" aria-controls="collapseTen">
                                Consideraciones Relativas Eliminaci√≥n
                            </a>
                        </h4>
                    </div>
                    <div id="collapseTen" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTen">
                        <div class="panel-body">
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group">{{ form.product.label_tag }} {{ form.product }}</div>
                                    <div class="form-group">{{ form.contaminated_packaging.label_tag }} {{ form.contaminated_packaging }}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="panel panel-default">
                    <div class="panel-heading" role="tab" id="headingTwelve">
                        <h4 class="panel-title">
                            <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseTwelve" aria-expanded="false" aria-controls="collapseTwelve">
                                Informaci√≥n Reglamentaria
                            </a>
                        </h4>
                    </div>
                    <div id="collapseTwelve" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingEleven">
                        <div class="panel-body">
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group">{{ form.regulations_legislation.label_tag }} {{ form.regulations_legislation }}</div>
                                    <div class="form-group">{{ form.chemical_safety_assessment.label_tag }} {{ form.chemical_safety_assessment }}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="panel panel-default">
                    <div class="panel-heading" role="tab" id="headingThirteen">
                        <h4 class="panel-title">
                            <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseThirteen" aria-expanded="false" aria-controls="collapseThirteen">
                                Otra Informacion
                            </a>
                        </h4>
                    </div>
                    <div id="collapseThirteen" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThirteen">
                        <div class="panel-body">
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group">{{ form.full_text_statements.label_tag }} {{ form.full_text_statements }}</div>
                                    <div class="form-group">{{ form.full_text_phrases.label_tag }} {{ form.full_text_phrases }}</div>
                                    <div class="form-group">{{ form.other_data_text.label_tag }} {{ form.other_data_text }}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
        <div class="col-md-12 text-center" style="display:inline-block">
            <button type="submit" class="btn btn-success">Continuar</button>
        </div>
    </form>
</div>
<div id="provider_modal" class="modal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">{% trans 'Add Provider' %}</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="provider_form">
                    {{provider_form.as_inline}}
                </form>
            </div>
            <div class="modal-footer">
                <button id="provider_add" type="button" class="btn btn-success" data-dismiss="modal">{% trans 'Add' %}</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">{% trans 'Close' %}</button>
            </div>
        </div>
    </div>
</div>

{% endblock %}
{% block js %}
{{block.super}}
<script>
    $("#provider_add").click(()=>{
    const formEntries = new FormData(document.querySelector('#provider_form')).entries();
    const json = Object.assign(...Array.from(formEntries, ([x,y]) => ({[x]:y})));

    $.ajax({
      method: "POST",
      url: "{% url 'add_sga_provider' %}",
      headers: {'X-CSRFToken': getCookie('csrftoken')},
      data: json
    }).done(function(data){
        if(data.result){
            document.getElementById("provider_form").reset();
        }

    })
   })
    </script>
{% endblock %}